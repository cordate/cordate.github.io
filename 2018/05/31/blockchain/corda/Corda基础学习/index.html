<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.0.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.0.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.0.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.0.4">


  <link rel="mask-icon" href="/images/logo.svg?v=6.0.4" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.0.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  
  <meta name="keywords" content="corda,r3," />


<meta name="description" content="在上一篇的博客中，我提到了Corda的一些基础的知识，但是那个版本是比较旧的，这次针对新的版本，写一些笔记来完成相应的更新。 Corda Network关于Corda的网络，有以下几点：  这个网络由运行Corda和CorDapps的节点组成。 网络是授权的，通过doorman控制权限 节点之间的通信是点对点的，不依赖全局广播。  Network结构Corda网络是一个认证的节点点对点网络，里面每">
<meta name="keywords" content="corda,r3">
<meta property="og:type" content="article">
<meta property="og:title" content="Corda基础学习">
<meta property="og:url" content="http://cordate.github.io/2018/05/31/blockchain/corda/Corda基础学习/index.html">
<meta property="og:site_name" content="柳絮纷飞">
<meta property="og:description" content="在上一篇的博客中，我提到了Corda的一些基础的知识，但是那个版本是比较旧的，这次针对新的版本，写一些笔记来完成相应的更新。 Corda Network关于Corda的网络，有以下几点：  这个网络由运行Corda和CorDapps的节点组成。 网络是授权的，通过doorman控制权限 节点之间的通信是点对点的，不依赖全局广播。  Network结构Corda网络是一个认证的节点点对点网络，里面每">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://github.com/gavin-account/blog-pics/blob/master/blockchain/corda%E7%BD%91%E7%BB%9C.png?raw=true">
<meta property="og:image" content="https://github.com/gavin-account/blog-pics/blob/master/blockchain/corda/ledger-venn.png?raw=true">
<meta property="og:image" content="https://github.com/gavin-account/blog-pics/blob/master/blockchain/corda/ledger-table.png?raw=true">
<meta property="og:image" content="https://docs.corda.net/releases/release-V3.1/_images/state.png">
<meta property="og:image" content="https://docs.corda.net/releases/release-V3.1/_images/state-sequence.png">
<meta property="og:image" content="https://docs.corda.net/releases/release-V3.1/_images/tx-validation.png">
<meta property="og:image" content="https://docs.corda.net/releases/release-V3.2/_images/basic-tx.png">
<meta property="og:image" content="https://docs.corda.net/releases/release-V3.2/_images/tx-chain.png">
<meta property="og:image" content="https://docs.corda.net/releases/release-V3.1/_images/uncommitted_tx.png">
<meta property="og:image" content="https://docs.corda.net/releases/release-V3.1/_images/tx_with_sigs.png">
<meta property="og:image" content="https://docs.corda.net/releases/release-V3.1/_images/committed_tx.png">
<meta property="og:image" content="https://docs.corda.net/releases/release-V3.2/_images/full-tx.png">
<meta property="og:image" content="https://docs.corda.net/releases/release-V3.1/_images/commands.png">
<meta property="og:image" content="https://docs.corda.net/releases/release-V3.1/_images/flow.gif">
<meta property="og:image" content="https://docs.corda.net/releases/release-V3.1/_images/flow-sequence.png">
<meta property="og:image" content="https://docs.corda.net/releases/release-V3.1/_images/node-architecture.png">
<meta property="og:updated_time" content="2018-09-16T15:47:32.456Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Corda基础学习">
<meta name="twitter:description" content="在上一篇的博客中，我提到了Corda的一些基础的知识，但是那个版本是比较旧的，这次针对新的版本，写一些笔记来完成相应的更新。 Corda Network关于Corda的网络，有以下几点：  这个网络由运行Corda和CorDapps的节点组成。 网络是授权的，通过doorman控制权限 节点之间的通信是点对点的，不依赖全局广播。  Network结构Corda网络是一个认证的节点点对点网络，里面每">
<meta name="twitter:image" content="https://github.com/gavin-account/blog-pics/blob/master/blockchain/corda%E7%BD%91%E7%BB%9C.png?raw=true">






  <link rel="canonical" href="http://cordate.github.io/2018/05/31/blockchain/corda/Corda基础学习/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>
  <title>Corda基础学习 | 柳絮纷飞</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">柳絮纷飞</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Gavin的个人博客</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
        </li>
      

      
    </ul>
  

  
</nav>


  



 </div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://cordate.github.io/2018/05/31/blockchain/corda/Corda基础学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gavin Zhang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/user-avatar">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="柳絮纷飞">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Corda基础学习</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-31T17:40:02+08:00">2018-05-31</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/区块链/" itemprop="url" rel="index"><span itemprop="name">区块链</span></a></span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/区块链/corda/" itemprop="url" rel="index"><span itemprop="name">corda</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>在上一篇的博客中，我提到了Corda的一些基础的知识，但是那个版本是比较旧的，这次针对新的版本，写一些笔记来完成相应的更新。</p>
<h2 id="Corda-Network"><a href="#Corda-Network" class="headerlink" title="Corda Network"></a>Corda Network</h2><p>关于Corda的网络，有以下几点：</p>
<ol>
<li>这个网络由运行Corda和CorDapps的节点组成。</li>
<li>网络是授权的，通过doorman控制权限</li>
<li>节点之间的通信是点对点的，不依赖全局广播。</li>
</ol>
<h3 id="Network结构"><a href="#Network结构" class="headerlink" title="Network结构"></a>Network结构</h3><p>Corda网络是一个认证的节点点对点网络，里面每一个节点都是有Corda服务并且执行CorDapps应用的JVM运行环境。</p>
<p><b style="color:red">节点之间的通信是直接的，通过AMQP/1.0发送TLS加密的信息。是点对点的，不采用广播的方式。</b></p>
<p><b style="color:blue">每个网络存在网络映射(map)服务，可以发布网络上每个节点都可以访问的IP地址，以及这些节点的身份证书和它们提供的服务。</b></p>
<h3 id="doorman"><a href="#doorman" class="headerlink" title="doorman"></a>doorman</h3><p>Corda网络是半私人的。每个网络都有一个门卫服务，用于执行关于节点必须提供的信息的规则以及他们在被允许进入网络之前必须完成的了解您的客户(KYC)流程。</p>
<p>要加入网络，节点必须联系门卫并提供所需的信息。如果门卫感到满意，该节点将从网络的许可服务接收根权威机构签署的TLS证书。此证书在与网络上的其他参与者通信时验证节点的身份。</p>
<p><b style="color:red">注：在源码中发现就是发送http请求，而且还要设置一个URL。详细的信息可以参阅源码部分。</b></p>
<p>我们可以将网络可视化如下：</p>
<p><img src="https://github.com/gavin-account/blog-pics/blob/master/blockchain/corda%E7%BD%91%E7%BB%9C.png?raw=true" alt=""></p>
<h3 id="Network中的服务"><a href="#Network中的服务" class="headerlink" title="Network中的服务"></a>Network中的服务</h3><p>节点可以提供几种类型的服务：</p>
<ul>
<li>一个或多个可插式公证服务。公证人保证分类账更新的唯一性和可能性。每个公证服务可以在单个节点上运行，也可以在一组节点上运行。</li>
<li>零个或更多的Oracle服务。Oracle是一个众所周知的服务，<b style="color:red">如果他们陈述事实并且事实被认为是真实的，那么它就会签署交易。</b></li>
</ul>
<h2 id="账本Ledger"><a href="#账本Ledger" class="headerlink" title="账本Ledger"></a>账本Ledger</h2><p>概要</p>
<ul>
<li>分类账从每个节点的角度来看都是透明的对象</li>
<li>两个节点总是保证看到他们分享的任何分类账事实完全相同的版本</li>
</ul>
<h3 id="概观"><a href="#概观" class="headerlink" title="概观"></a>概观</h3><p>在Corda，没有单一的中央数据存储。相反，每个节点都维护一个已知事实的单独数据库。因此，每个节点只能看到分类帐上的一小部分事实，并且没有节点完全知道分类账。</p>
<p>例如，想象一个具有五个节点的网络，其中每个彩色圆圈表示一个共享事实：</p>
<p><img src="https://github.com/gavin-account/blog-pics/blob/master/blockchain/corda/ledger-venn.png?raw=true" alt=""></p>
<p>我们可以看到尽管Carl，Demi和Ed都感知了事实3，，但是Alice和Bob却不知道事实3的存在。</p>
<p>同样重要的是，Corda保证，无论何时这些事实中的一个在网络多个节点间共享，它在每个知道它的节点的数据库中以锁的方式发展。<br><img src="https://github.com/gavin-account/blog-pics/blob/master/blockchain/corda/ledger-table.png?raw=true" alt=""></p>
<p>例如，Alice和Bob都会看到共享事实1和7的相同版本。</p>
<h2 id="身份Identity"><a href="#身份Identity" class="headerlink" title="身份Identity"></a>身份Identity</h2><p>概要</p>
<ul>
<li>Corda中的身份可以代表合法身份或服务身份</li>
<li><b style="color:red">身份证明由门卫签署的X.509证书或公认的身份证明</b></li>
<li>众所周知的身份发布在网络地图(map)中（NetworkMapService，这个在源码中我们也可以看到）</li>
<li>机密身份仅在需要知道的基础上共享</li>
</ul>
<p>Corda中的身份可以表示：</p>
<ul>
<li>一个组织的法律身份</li>
<li>网络服务的服务标识（该节点只是提供服务而已）</li>
</ul>
<p><b style="color:red">法律身份用于交易中的各方，例如现金状态的所有者。服务标识用于提供与交易相关的服务的人员，例如公证人员或oracle。</b>服务身份与合法身份不同，因此分布式服务可以存在于不同组织所拥有的节点上。这种分布式服务身份是基于的<code>CompositeKeys</code>，它描述了服务签名的有效签名者集合。有关<code>CompositeKeys</code>的更多技术细节，请参阅<a href="https://docs.corda.net/releases/release-V3.1/api-core-types.html" target="_blank" rel="noopener">API：核心类型</a>。</p>
<p><b style="color:red">身份是众所周知的还是保密的，取决于他们的X.509证书（和对应的证书路径是否可信的根证书）已发布：</b>.</p>
<ul>
<li>众所周知的身份是法律实体或服务的一般可识别的公钥，这使得它们不适用于需要参与者保密的交易。<b style="color:blue">此证书已发布在网络地图服务中供任何人访问。</b></li>
<li>机密身份只发布给参与交易的人员。公钥可能暴露给第三方（例如公证服务），但名称和X.509证书的分发是受限的。</li>
</ul>
<p>虽然Corda交易隐私模式有几个要素，包括确保交易只与需要查看它们的用户共享以及有计划地使用英特尔SGX，但重要的是要提供深入的防御隐私攻击。机密身份用于确保即使第三方访问未加密的交易，他们也无法在没有附加信息的情况下识别参与者。</p>
<h3 id="证书"><a href="#证书" class="headerlink" title="证书"></a>证书</h3><p>节点必须能够验证使用X.509证书实现的公钥所有者的身份。<b style="color:red">首次运行时，节点生成密钥对并向网络门卫服务提交证书签名请求</b>（请参阅 <a href="https://docs.corda.net/releases/release-V3.1/permissioning.html" target="_blank" rel="noopener">网络许可</a>）。Doorman服务应用适当的身份检查，<b style="color:red">然后向用作节点认证中心（CA）的节点发放证书</b>。从该初始CA证书中，节点自动创建并签署两个其他证书，一个TLS证书(sslKeyStore)和一个用于该节点众所周知的身份的签名证书(nodeKeyStore)。最后，节点建立包含其地址和众所周知的身份的节点信息记录，并将其注册到网络地图服务。</p>
<p>组织可以从签署证书创建公开和机密身份。众所周知的身份的用例包括代表用于冗余目的的单个身份的节点集群，或者为组织单位创建身份。</p>
<p>组织需要决定他们希望在网络地图服务中发布哪些身份，使其广为人知，并且出于隐私原因（通常是为了避免暴露商业敏感的交易细节），他们希望将其保留为机密身份。<b style="color:red">在某些情况下，出于操作原因，除了主网络地图服务之外，节点还可能使用专用网络地图服务。</b>使用此类网络地图注册的身份必须被认为是众所周知的，并且将机密身份存储在中央目录中，而不在记录级别应用控制，以确保只有需要访问身份的人才能检索其证书。</p>
<h2 id="状态"><a href="#状态" class="headerlink" title="状态"></a>状态</h2><p>概要：</p>
<ul>
<li>状态代表了分类账事实</li>
<li>通过将当前状态标记为历史的并创建更新状态来进行状态演变</li>
<li>每个节点都有一个保管库（Vault，可以是放入数据库中，有相应接口，默认是放在内存中），它在其中存储任何相关的状态</li>
</ul>
<h3 id="概观-1"><a href="#概观-1" class="headerlink" title="概观"></a>概观</h3><p>状态可以包含任意数据，允许它们表示任何种类的事实（例如股票，债券，贷款，KYC数据，身份信息……）。例如，以下状态代表IOU - Alice欠Bob的协议金额X：</p>
<p><img src="https://docs.corda.net/releases/release-V3.1/_images/state.png" alt=""></p>
<p>除了关于事实本身的任何信息外，状态还包含对管理状态演变随时间推移的合约（Contract）的引用。</p>
<h3 id="状态序列"><a href="#状态序列" class="headerlink" title="状态序列"></a>状态序列</h3><p>共享事实随时间的生命周期由状态序列表示。当一个状态需要更新时，我们创建代表新状态的新版本状态，并将现有状态标记为历史状态。</p>
<p><img src="https://docs.corda.net/releases/release-V3.1/_images/state-sequence.png" alt=""></p>
<h3 id="金库-Vault"><a href="#金库-Vault" class="headerlink" title="金库(Vault)"></a>金库(Vault)</h3><p>网络上的每个节点都有一个保管库（Vault） - 一个数据库，用于追踪所有当前和历史状态，以及它认为与自身相关的所有当前状态和历史状态.</p>
<h2 id="合约"><a href="#合约" class="headerlink" title="合约"></a>合约</h2><p>概要</p>
<ul>
<li>每个输入和输出状态的合约都必须接受有效的交易</li>
<li>合约是用JVM编程语言（如Java或Kotlin）编写的，</li>
<li>合约执行是确定性的，其对交易的接受仅基于交易的内容</li>
</ul>
<h3 id="交易验证"><a href="#交易验证" class="headerlink" title="交易验证"></a>交易验证</h3><p>回想一下，交易只有在所有必需的签名者都进行了数字签名的情况下才有效。但是，即使交易收集了所有必需的签名，它也仅在合约有效的情况下才有效。</p>
<p>合约有效性定义如下：</p>
<ul>
<li><b style="color:red">每个状态都指向一份合约</b></li>
<li>一个合约需要一个交易作为输入，并指出根据合约的规则的交易是否被认为是有效的</li>
<li>只有当每个输入状态和每个输出状态的合约认为其有效时，交易才有效</li>
</ul>
<p><img src="https://docs.corda.net/releases/release-V3.1/_images/tx-validation.png" alt=""></p>
<p>合约代码可以用任何JVM语言编写，并且可以使用该语言的全部功能，包括：</p>
<ul>
<li><b style="color:red">检查输入，输出，命令，时间戳和/或附件的数量</b></li>
<li>检查这些组件的内容</li>
<li>循环结构，变量赋值，函数调用，辅助方法等</li>
<li>将类似的状态分组以验证它们是否为一组（例如，对所有现金状态的总价值施加一个规则）</li>
</ul>
<p>非合约有效的交易不是更新分类帐的有效提案，因此不能提交给分类账。通过这种方式，合约对状态随时间推移的演变规定了独立于所需签名人签署给定交易的意愿的规则。</p>
<h3 id="合约沙箱"><a href="#合约沙箱" class="headerlink" title="合约沙箱"></a>合约沙箱</h3><p>交易验证必须是确定性的 - 合约应始终接受或始终拒绝给定的交易。例如，交易有效性不能取决于进行验证的时间，也不取决于合作伙伴运行合约的信息量。这是确保网络上的所有同行对特定分类帐更新的有效性达成共识的必要条件。</p>
<p><b style="color:red">为了达到这个目的，合约评估确定性沙箱中的交易。沙盒有一个白名单（这就是在源码看到的WhiteList的作用了吧，不过这个白名单是针对附件的），可以防止合约导入可能成为非确定性来源的库</b>。这包括提供当前时间的库，随机数生成器，提供文件系统访问的库或网络库等。最终，验证交易时可用于合约的唯一信息是交易本身中包含的信息。</p>
<h3 id="合约限制"><a href="#合约限制" class="headerlink" title="合约限制"></a>合约限制</h3><p>由于合约无法获得外部信息，它只能检查交易的内部有效性。例如，它不能检查交易是否与最初与交易对手达成一致。</p>
<p>因此，节点在签署交易之前应检查交易内容，即使交易合约有效，以查看他们是否同意提议的分类帐更新。节点没有义务签署一项交易，只是因为它在合约中有效。例如，他们可能不愿意承担过大的贷款，或可能不同意为资产提供的现金数额。</p>
<h3 id="神谕（Oracle）"><a href="#神谕（Oracle）" class="headerlink" title="神谕（Oracle）"></a>神谕（Oracle）</h3><p>有时，交易有效性将取决于一些外部信息，例如汇率。在这些情况下，需要一个oracle。有关更多详细信息，请参阅<a href="https://docs.corda.net/releases/release-V3.2/key-concepts-oracles.html" target="_blank" rel="noopener">Oracles</a>。</p>
<h3 id="法律散文（legal-prose）"><a href="#法律散文（legal-prose）" class="headerlink" title="法律散文（legal prose）"></a>法律散文（legal prose）</h3><p>每份合约还涉及法律散文文件，其中规定了与传统法律体系兼容的随时间推移的状态演变规则。在法律纠纷的情况下，可以依靠这份文件。</p>
<h2 id="交易"><a href="#交易" class="headerlink" title="交易"></a>交易</h2><p>概要</p>
<ul>
<li>交易是更新分类账的提案</li>
<li>交易提案承诺以下情况：<ul>
<li>它不包含双重花费</li>
<li>这是合约有效的</li>
<li>它由所需方签署</li>
</ul>
</li>
</ul>
<p>Corda使用UTXO（未使用的交易输出）模型。其中分类帐上的每个状态都是不可变的。分类账通过应用交易随着时间的推移而发展，交易通过将零个或多个现有分类账状态标记为历史（输入）并产生零个或多个新分类账状态（输出）来更新分类账。交易表示在状态中看到的状态序列中的单个链接。<br><img src="https://docs.corda.net/releases/release-V3.2/_images/basic-tx.png" alt=""></p>
<p>交易可以包含任何数量任何类型的输入和输出：</p>
<ul>
<li>可以包含很多不同的状态类型（比如，包含现金和股票）</li>
<li><b style="color:red">可以是发行的（没有任何输入）或者退出（没有任何输出）</b></li>
<li>他们可以合并或者分割可替代资产（就像付10元收2元找8元）</li>
</ul>
<p>交易是原子的：要么所有交易的提议变更都被接受，要么都没有。</p>
<p>这里有两种基础交易类型：</p>
<ul>
<li>公证改变交易（用来改变一个状态的公证人，参阅<a href="https://docs.corda.net/releases/release-V3.2/key-concepts-notaries.html" target="_blank" rel="noopener">Notaries</a>）</li>
<li>普通的交易（其它的交易）</li>
</ul>
<h3 id="交易链"><a href="#交易链" class="headerlink" title="交易链"></a>交易链</h3><p>在创建新交易时，交易将申明的输出状态尚不存在，因此必须由交易提议者创建。但是，输入状态已作为先前交易的输出存在。因此，我们将其纳入拟议的交易中。</p>
<p>这些输入状态引用是下面的组合：</p>
<ul>
<li>交易创建输入的hash</li>
<li>输入的在上一个交易中的输出的索引</li>
</ul>
<p>这个情况可以使用下图来说明：<br><img src="https://docs.corda.net/releases/release-V3.2/_images/tx-chain.png" alt=""></p>
<p>这些输入状态引用（StateRef）将交易连接在一起，形成所谓的交易链。</p>
<h3 id="提交交易"><a href="#提交交易" class="headerlink" title="提交交易"></a>提交交易</h3><p>最初，交易只是更新分类帐的建议.<br><img src="https://docs.corda.net/releases/release-V3.1/_images/uncommitted_tx.png" alt=""></p>
<p>要成为现实，交易必须接收所有必需的签名者的签名（参见下面的命令）。每位必需的签名者将其签名附加到交易中以表明他们批准该提案：<br><img src="https://docs.corda.net/releases/release-V3.1/_images/tx_with_sigs.png" alt=""></p>
<p>如果所有必需的签名都被收集起来，交易将变为已提交：<br><img src="https://docs.corda.net/releases/release-V3.1/_images/committed_tx.png" alt=""></p>
<p>这意味着：</p>
<ul>
<li>交易的输入被标记为历史性的，并且不能用于任何未来的交易</li>
<li>交易的产出成为分类账当前状态的一部分</li>
</ul>
<h3 id="交易有效性"><a href="#交易有效性" class="headerlink" title="交易有效性"></a>交易有效性</h3><p>如果以下两个条件成立，每个必需的签名者只应签署交易：</p>
<ul>
<li>交易有效性：对于提议的交易以及创建当前提议的交易输入的交易链中的每个交易：<ul>
<li>交易由所有必要方进行数字签名</li>
<li>合约验证交易有效（查看<a href="https://docs.corda.net/releases/release-V3.2/key-concepts-contracts.html" target="_blank" rel="noopener">Contracts</a>）</li>
</ul>
</li>
<li>交易唯一性：没有其他交易已经消耗了我们建议交易的任何投入</li>
</ul>
<h3 id="其他交易组件"><a href="#其他交易组件" class="headerlink" title="其他交易组件"></a>其他交易组件</h3><p>除输入状态和输出状态外，交易可能包含：</p>
<ul>
<li>命令Commands</li>
<li>附件Attachments</li>
<li>时间戳Timestamps</li>
</ul>
<p>例如，一项交易，其中Alice使用5英镑的现金支付与Bob支付5英镑的欠条，由两个附件和时间戳支持，可能如下所示：<br><img src="https://docs.corda.net/releases/release-V3.2/_images/full-tx.png" alt=""></p>
<p>我们将探讨下面剩余交易组件所扮演的角色。</p>
<h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><p>假设我们有一个以现金状态和债券状态作为输入的交易，以现金状态和债券状态作为输出。该交易可能代表两种不同的情况：</p>
<ul>
<li>债券购买</li>
<li>债券上的息票支付</li>
</ul>
<p>我们可以想象，我们希望对构成有效交易的内容施加不同的规则，具体取决于这是购买还是优惠券付款。例如，在购买的情况下，我们需要改变债券的当前所有者，而在支付息票的情况下，我们会要求债券的所有权不变。</p>
<p>为此，我们有命令。在交易中包含命令可以让我们指出交易的意图，从而影响我们如何检查交易的有效性。</p>
<p>每个命令还与一个或多个签名者列表关联。通过将命令中列出的所有公钥的联合，我们得到交易所需的签名者列表。在我们的例子中，我们可以想象：</p>
<ul>
<li>在债券的息票付款中，只有债券所有者需要签署</li>
<li>在现金支付中，只需要现金的所有者签字</li>
</ul>
<p>我们可以看到这种情况如下：<br><img src="https://docs.corda.net/releases/release-V3.1/_images/commands.png" alt=""></p>
<h3 id="附件"><a href="#附件" class="headerlink" title="附件"></a>附件</h3><p>有时，我们有大量的数据可以在许多不同的交易中重用。一些例子：</p>
<ul>
<li>公众假期日历</li>
<li>支持法律文件</li>
<li>货币代码表</li>
</ul>
<p>对于这个用例，我们有附件。每个交易可以通过哈希引用零个或多个附件。这些附件是包含任意内容的ZIP/JAR文件。这些文件中的信息可以在检查交易的有效性时使用。</p>
<h3 id="时间窗口"><a href="#时间窗口" class="headerlink" title="时间窗口"></a>时间窗口</h3><p>在某些情况下，我们希望建议的交易只能在特定时间段内批准。例如：</p>
<ul>
<li>期权只能在特定日期后执行</li>
<li>债券只能在到期日前赎回</li>
</ul>
<p>在这种情况下，我们可以为交易添加一个时间窗口。时间窗口指定了可以提交交易的时间窗口。我们讨论时间窗口部分的时间窗口。</p>
<h2 id="流程（Flow）"><a href="#流程（Flow）" class="headerlink" title="流程（Flow）"></a>流程（Flow）</h2><p>概要</p>
<ul>
<li>流程自动化了同意分类帐更新的过程</li>
<li>节点之间的通信只发生在这些流程的上下文中，并且是点对点的</li>
<li>提供了内置流程来自动化常见任务</li>
</ul>
<h3 id="动机"><a href="#动机" class="headerlink" title="动机"></a>动机</h3><p>Corda网络使用点对点消息而不是全局广播。这意味着协调分类帐更新需要网络参与者准确指定需要发送的信息，交易对手以及以何种顺序。</p>
<p>以下是在Alice和Bob之间就简单分类账更新达成一致的过程的可视化：</p>
<p><img src="https://docs.corda.net/releases/release-V3.1/_images/flow.gif" alt=""></p>
<h3 id="流程框架"><a href="#流程框架" class="headerlink" title="流程框架"></a>流程框架</h3><p>Corda不需要手动指定这些步骤，而是使用流程自动化流程。流程是一系列步骤，告诉节点如何实现特定的分类帐更新，例如发放资产或结算交易。</p>
<p>以下是上述简单分类账更新中涉及的流程步骤顺序：<br><img src="https://docs.corda.net/releases/release-V3.1/_images/flow-sequence.png" alt=""></p>
<h3 id="运行流程"><a href="#运行流程" class="headerlink" title="运行流程"></a>运行流程</h3><p>一旦给定的业务流程被封装在流中并作为CorDapp的一部分安装在节点上，节点的所有者就可以指示节点随时使用RPC调用启动该业务流程。该流程将所有网络，I / O和并发问题从节点所有者中抽象出来。</p>
<p>节点上的所有活动都发生在这些流程的上下文中。与合约不同，流程不在沙箱中执行，这意味着节点可以执行诸如网络，I/O等操作，并在流程执行过程中使用随机源。</p>
<h4 id="节点间通信"><a href="#节点间通信" class="headerlink" title="节点间通信"></a>节点间通信</h4><p>节点通过在流之间传递消息进行通信。每个节点具有零个或多个流类，它们被注册为响应来自单个其他流的消息。</p>
<p>假设Alice是网络上的一个节点，并希望与另一个网络节点Bob同意分类帐更新。为了与Bob沟通，Alice必须：</p>
<ul>
<li>开始注册Bob回应的流程</li>
<li>在该流程的上下文中向Bob发送消息</li>
<li>鲍勃将开始注册的交易对手流程</li>
</ul>
<p>现在建立了一个连接，Alice和Bob可以通过传递一系列来回传递的消息来同意分类账更新，如流程步骤中所规定的那样。</p>
<h4 id="子流程"><a href="#子流程" class="headerlink" title="子流程"></a>子流程</h4><p>可以通过在另一个流程的上下文中将流程作为子流程启动来组成流程。作为子流程开始的流程称为子流程。父流程将一直等到子流程返回。</p>
<h4 id="流程库"><a href="#流程库" class="headerlink" title="流程库"></a>流程库</h4><p>Corda提供了一个处理常见任务的流程库，这意味着开发人员不必重新定义常见流程背后的逻辑，例如：</p>
<ul>
<li>公证和记录交易</li>
<li>从对手方节点收集签名</li>
<li>验证一系列交易</li>
</ul>
<p>有关可用内置流程的更多信息，请参见<a href="https://docs.corda.net/releases/release-V3.1/flow-library.html" target="_blank" rel="noopener">Flow库</a>。</p>
<h3 id="并发"><a href="#并发" class="headerlink" title="并发"></a>并发</h3><p>流程框架允许节点一次有多个活动流。这些流量可能持续数天，跨节点重启甚至升级。</p>
<p>这是通过将数据流序列化到磁盘来实现的，只要它们进入阻塞状态（例如，当它们正在等待I / O或网络呼叫时）。与其等待流程畅通无阻，节点立即开始处理任何其他计划流程，仅在以后返回到原始流程。</p>
<h2 id="共识"><a href="#共识" class="headerlink" title="共识"></a>共识</h2><p>概要</p>
<ul>
<li>承诺，交易必须达到有效性和唯一性共识</li>
<li>有效性共识需要交易及其所有依赖关系的合约有效性</li>
<li>唯一性共识可以防止双重花费</li>
</ul>
<h3 id="两种共识"><a href="#两种共识" class="headerlink" title="两种共识"></a>两种共识</h3><p>确定提议的交易是否是有效的分类帐更新涉及达成两种类型的共识：</p>
<ul>
<li>有效性共识 - 在签署交易前由每个必需签署者检查</li>
<li>唯一性共识 - 只有公证服务才能检查</li>
</ul>
<p>有效性共识是检查以下条件是否适用于拟议交易以及交易链中为交易提议交易产生输入的每个交易的过程：</p>
<ul>
<li>交易被每个输入和输出状态的合约所接受</li>
<li>交易拥有所有必需的签名</li>
</ul>
<p>验证提议的交易本身是不够的。我们还必须核实导致建立交易建议输入的交易链中的每一笔交易。</p>
<p>这就是所谓的走链。例如，假设网络上的一方提出将我们的国债转让给我们的交易。在下列情况下，我们只能确保债券转移有效：</p>
<ul>
<li>国债是由中央银行在有效的发行交易中发行的</li>
<li>债券交易后的每一次交易都是有效的</li>
</ul>
<h3 id="唯一性共识"><a href="#唯一性共识" class="headerlink" title="唯一性共识"></a>唯一性共识</h3><p>唯一性共识是要求所提议的交易的投入没有一个在另一笔交易中已经消耗。</p>
<p>如果一个或多个输入已经在另一个交易中被使用，这就是所谓的双重支出，并且交易提议被认为是无效的。</p>
<p>公证人提供了唯一性共识。请参阅公证人了解更多详情。</p>
<h2 id="公证人（Notary）"><a href="#公证人（Notary）" class="headerlink" title="公证人（Notary）"></a>公证人（Notary）</h2><p>概要</p>
<ul>
<li>公证人防止“双花”</li>
<li>公证员也可以选择验证交易</li>
<li>一个网络可以有几个公证人，每个公证人都运行不同的共识算法</li>
</ul>
<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>一个公证是一种网络服务，它提供了独特的共识被证明的是，对于一个给定的交易，它尚未签署消耗任何拟议中的交易的输入状态的其他交易。</p>
<p>在被要求公证交易时，公证人可以：</p>
<ul>
<li>如果交易尚未签署其他消耗建议交易输入状态的交易，请签署交易</li>
<li>拒绝该交易并标记双重支出尝试已经发生</li>
</ul>
<p>这样做，公证人提供了系统中的终点。在获得公证人的签名之前，各方不能确定同等有效但冲突的交易不会被视为花费给定输入状态的“有效”尝试。但是，在获得公证人的签名后，我们可以确定提议的交易的输入状态尚未被先前的交易消耗。因此，公证是系统中的终点。</p>
<p>每个状态都有一个指定的公证人，如果公证人是所有交易输入状态的指定公证人，公证人只会公证一项交易。</p>
<h3 id="共识算法"><a href="#共识算法" class="headerlink" title="共识算法"></a>共识算法</h3><p>Corda具有“可插入”的共识，允许公证人根据隐私，可扩展性，法律系统兼容性和算法敏捷性的要求选择一致的算法。</p>
<p>特别是，公证人在以下方面可能会有所不同：</p>
<ul>
<li>结构 - 公证可能是单个网络节点，相互信任的节点群或相互不信任的节点群</li>
<li>共识算法 - 公证服务可以选择运行高速，高可信度算法，如RAFT，低速低信任算法（如BFT），或者其他任何其他共识算法</li>
</ul>
<h4 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h4><p>公证服务还必须在提交之前通过确认每笔交易来决定是否提供有效性共识。在作出这个决定时，他们面临以下的交易：</p>
<ul>
<li><b style="color:red">如果一个交易没有被检查有效性，它会产生“拒绝状态”攻击的风险，在这种情况下，一个节点明知地建立一个无效的事务，消耗一些现有状态并将其发送给公证人，导致这些状态被标记为已消耗。（这是攻击风险，需要验证交易合法性以抵制这种攻击）</b>.</li>
<li>如果交易被检查的有效性，公证员将需要看到交易及其依赖的全部内容。这泄露了可能的私人数据给公证人</li>
</ul>
<p>在评估这种折衷时，还有几点需要注意。在非验证模型的情况下，Corda的受控数据分布模型意味着关于未消费状态的信息并未广泛共享。此外，Corda的许可网络意味着公证人可以存储创建“拒绝状态”交易的一方的身份，从而使得攻击能够逐个解决。</p>
<p>在验证模型的情况下，使用匿名的，新近生成的公钥而不是法定身份来识别交易中的当事方会限制公证人看到的信息。</p>
<h3 id="多个公证人"><a href="#多个公证人" class="headerlink" title="多个公证人"></a>多个公证人</h3><p>每个Corda网络可以有多个公证员，每个公证员可能运行不同的共识算法。这提供了几个好处：</p>
<ul>
<li>隐私 - 我们可以在同一网络上同时具有验证和非验证公证服务，每个都运行不同的算法。这使得节点能够按照每个交易选择首选公证人</li>
<li>负载平衡 - 通过多个公证处理交易负载可以为整个平台提供更高的交易吞吐量</li>
<li>低等待时间 - 等待时间可以通过选择与交易双方身体接近的公证员来最小化</li>
</ul>
<h4 id="改变公证人"><a href="#改变公证人" class="headerlink" title="改变公证人"></a>改变公证人</h4><p>请记住，如果公证人是所有交易输入状态的指定公证人，则公证人只会签署交易。但是，有些情况下我们可能需要更换状态的指定公证人。这些包括：</p>
<ul>
<li>当单个交易需要消耗具有不同指定公证人的多个状态时</li>
<li>由于隐私或效率问题，节点宁愿为给定的交易使用不同的公证人</li>
</ul>
<p>在这些交易可以创建之前，必须首先将各状态重新命名为全部具有相同的公证人。这是通过使用特殊的公证人更改交易来实现的，该交易需要：</p>
<ul>
<li>单个输入状态</li>
<li><b style="color:red">与输入状态相同的输出状态，但指定的公证人已更改（将输入的公证人更改掉作为输入即可）</b></li>
</ul>
<p>输入状态的指定公证人将签署交易，如果它不构成双重花费，此时一个状态将进入具有旧状态所有财产的存在，但具有不同的指定公证人。</p>
<h2 id="时间窗口-1"><a href="#时间窗口-1" class="headerlink" title="时间窗口"></a>时间窗口</h2><p>概要</p>
<ul>
<li>如果交易包含时间窗口，则只能在该窗口期间提交</li>
<li>公证人是时间戳管理机构，拒绝在该窗口之外提交交易</li>
<li>时间窗口可以有开始和结束时间，也可以在任何一端打开</li>
</ul>
<h3 id="在分布式系统中的时间"><a href="#在分布式系统中的时间" class="headerlink" title="在分布式系统中的时间"></a>在分布式系统中的时间</h3><p>公证人还充当时间戳的权力，验证在公证之前在特定时间窗口发生的交易。</p>
<p>创建交易的一方和公证人之间永远不会有精确的时钟同步。这不仅仅是由于物理和网络延迟的问题，而且还因为在插入命令和获得公证签名之间可能有许多其他步骤（例如将交易发送给交易中涉及的其他方，请求人签字…）。因此交易发送给公证人的时间可能与交易创建时间大不相同。</p>
<p>假设公证人的时间馈送是由美国海军天文台的原子钟定义的GPS / NaviStar时间。这个是非常准确的，全球免费提供。</p>
<h2 id="神谕（Oracle）-1"><a href="#神谕（Oracle）-1" class="headerlink" title="神谕（Oracle）"></a>神谕（Oracle）</h2><p>概要</p>
<ul>
<li>事实可以作为命令的一部分包含在交易中</li>
<li>如果包含的事实是真实的，则oracle是一种仅签署交易的服务</li>
</ul>
<h3 id="概观-2"><a href="#概观-2" class="headerlink" title="概观"></a>概观</h3><p>在很多情况下，交易的合约效力取决于一些外部数据，例如当前的汇率。但是，如果我们要让每个参与者根据他们自己对当前汇率的看法来评估交易的有效性，那么合同的执行将是非确定性的：一些签名者会认为交易是有效的，而另一些则认为它是无效的。因此，会在分类账的真实状态上产生分歧。</p>
<p>Corda使用oracles解决了这个问题。神谕（Oracle）是网络服务，根据请求提供封装特定事实（例如，时间x时的汇率）的命令，并将神谕列为必需的签名者。</p>
<p><b style="color:red">如果一个节点希望在交易中使用某个事实，他们会请求一个命令，从oracle中断言这个事实。如果oracle认为事实是真的，他们会发回所需的命令。然后节点将这个命令包含在他们的交易中，并且oracle将签署该交易来断言事实是真实的。</b></p>
<p>如果他们希望将他们的服务货币化，神谕可以选择只签署一笔交易，并证明其收取的费用是有效的。</p>
<h3 id="交易拆分"><a href="#交易拆分" class="headerlink" title="交易拆分"></a>交易拆分</h3><p><a href="/2018/05/30/blockchain/corda/Corda%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/#%E4%BA%A4%E6%98%93%E6%8B%86%E5%88%86">交易拆分</a></p>
<h2 id="节点"><a href="#节点" class="headerlink" title="节点"></a>节点</h2><p>概要</p>
<ul>
<li>节点是JVM运行时间，具有运行Corda软件的唯一网络标识</li>
<li>该节点有两个与外界的接口：<ul>
<li>网络层，用于与其他节点交互</li>
<li>RPC，用于与节点的所有者进行交互</li>
</ul>
</li>
<li>通过在插件注册表中安装CorDapps来扩展节点的功能</li>
</ul>
<h3 id="节点架构"><a href="#节点架构" class="headerlink" title="节点架构"></a>节点架构</h3><p>Corda节点是一个JVM运行时环境，在网络上具有唯一身份，用于承载Corda服务和CorDapps。</p>
<p>我们可以将节点的内部架构可视化如下：</p>
<p><img src="https://docs.corda.net/releases/release-V3.1/_images/node-architecture.png" alt=""></p>
<p>该体系结构的核心要素是：</p>
<ul>
<li>用于存储数据的持久层</li>
<li>用于与其他节点交互的网络接口</li>
<li>用于与节点所有者进行交互的RPC接口</li>
<li>一个服务中心（ServiceHub），用于允许节点的流程调用节点的其他服务</li>
<li>通过安装CorDapps扩展节点的cordapp界面和提供程序</li>
</ul>
<h3 id="持久层"><a href="#持久层" class="headerlink" title="持久层"></a>持久层</h3><p>持久层有两部分：</p>
<ul>
<li>Vault，其中节点存储任何相关的当前和历史状态</li>
<li>存储服务（StorageService），它存储数据，附件和流程检查点（checkpoints）</li>
</ul>
<p>节点的所有者可以使用RPC接口查询节点的存储（见下文）。</p>
<h3 id="网络接口"><a href="#网络接口" class="headerlink" title="网络接口"></a>网络接口</h3><p>作为运行流程的一部分，与网络中其他节点的所有通信都由节点本身处理。节点的所有者不直接与其他网络节点交互。</p>
<h3 id="RPC接口"><a href="#RPC接口" class="headerlink" title="RPC接口"></a>RPC接口</h3><p>节点的所有者通过远程过程调用（RPC）与节点交互。<a href="https://docs.corda.net/releases/release-V3.1/api-rpc.html" target="_blank" rel="noopener">API：RPC操作</a>记录了节点公开的关键<a href="https://docs.corda.net/releases/release-V3.1/api-rpc.html" target="_blank" rel="noopener">RPC操作</a>。</p>
<h3 id="服务中心（ServiceHub）"><a href="#服务中心（ServiceHub）" class="headerlink" title="服务中心（ServiceHub）"></a>服务中心（ServiceHub）</h3><p>在内部，节点可以访问在流程执行期间使用的一组丰富的服务，以协调分类帐更新。提供的主要服务是：</p>
<ul>
<li>有关网络上其他节点及其提供的服务的信息</li>
<li>访问保管库（Vault）内容和存储（Storage）服务</li>
<li>访问和生成节点的公钥 - 私钥对</li>
<li>关于节点本身的信息</li>
<li>当前时间，由节点跟踪</li>
</ul>
<h3 id="CorDapp提供商"><a href="#CorDapp提供商" class="headerlink" title="CorDapp提供商"></a>CorDapp提供商</h3><p>CorDapp提供程序是安装新的CorDapps以扩展节点行为的地方。</p>
<p>该节点还默认安装了几个CorDapps来处理常见任务，例如：</p>
<ul>
<li>检索交易对方的交易和附件</li>
<li>升级合同</li>
<li>广播商定的分类账更新以供对手方记录</li>
</ul>
<h4 id="排水模式（Draining-mode）"><a href="#排水模式（Draining-mode）" class="headerlink" title="排水模式（Draining mode）"></a>排水模式（Draining mode）</h4><p>为了使节点能够干净关闭，重要的是没有流程正在运行中，这意味着不应该坚持检查点。该节点能够处于流程排放模式，在此期间：</p>
<ul>
<li>需要通过RPC启动新流程的命令将被拒绝。</li>
<li>预计将要执行将被忽略。（那么这些流程应该如何进行处理呢？）</li>
<li>最初的P2P会话消息将不会被处理，这意味着对等方将无法发起涉及该节点的新流程。</li>
<li>所有其他活动将照常进行，确保机内流程的数量将严格减少。</li>
</ul>
<p>由于它们的数量（可以通过RPC进行监控）达到零，所以关闭节点是安全的。该属性是持久的，这意味着重新启动节点不会将其重置为默认值，并且需要RPC命令。</p>
<h2 id="权衡"><a href="#权衡" class="headerlink" title="权衡"></a>权衡</h2><p>概要</p>
<ul>
<li>权限的网络更适合财务用例</li>
<li>点对点通信允许共享需要知道的信息</li>
<li>UTXO模型允许每秒更多的交易处理</li>
</ul>
<h3 id="Permissioned-vs-permissionless"><a href="#Permissioned-vs-permissionless" class="headerlink" title="Permissioned vs. permissionless"></a>Permissioned vs. permissionless</h3><p>传统blockchain网络是permissionless。网络上的各方都是匿名的，可以随意加入和离开。</p>
<p>相比之下，Corda网络获得许可。网络上的每一方都有一个已知的身份，他们在与交易对手进行交流时使用，网络访问由门卫控制。这有几个好处：</p>
<ul>
<li>对于涉及受监管金融机构的大多数情况，匿名方不适用</li>
<li>了解您的交易对手的身份可以使用现有的法律体系，以分类方式解决冲突</li>
<li>如果没有使用诸如工作证明等昂贵的机制，Sybil攻击就可以避免</li>
</ul>
<h3 id="点对点与全球广播"><a href="#点对点与全球广播" class="headerlink" title="点对点与全球广播"></a>点对点与全球广播</h3><p>传统的区块链网络向每个参与者传播每一条消息。其原因有两方面：</p>
<ul>
<li>交易对手身份未知，因此必须将消息发送给每位参与者以确保其到达其预期接收者</li>
<li>让每个参与者意识到每一笔交易都可以让网络防止双重花费</li>
</ul>
<p>缺点是所有参与者都能看到其他人的数据。这在许多使用情况下是不可接受的。</p>
<p>在Corda中，每条消息都会发送给特定的对方，并且不会被任何无关的第三方看到。开发人员可以完全控制发送什么消息，向谁发送消息，以及按照什么顺序。因此，数据仅在需要知道的基础上共享。为了防止这种制度出现双重花费，我们聘请公证人作为工作证明的替代方案。</p>
<p>Corda还使用其他几种技术来最大化网络上的隐私：</p>
<ul>
<li>交易拆分：交易的结构方式允许他们在不公开交易内容的情况下进行数字签名。这是通过使用名为Merkle树的数据结构实现的。你可以在merkle-trees中阅读关于这种技术的更多信息。</li>
<li>密钥随机化：交易双方仅通过其公钥识别，并为每个交易生成新密钥对。因此，旁观者无法确定哪一方参与了某个交易。（公钥大家都可以看到，但是不会公布私钥，但是如何保证通信的安全是个问题）</li>
</ul>
<h3 id="UTXO与账户模式"><a href="#UTXO与账户模式" class="headerlink" title="UTXO与账户模式"></a>UTXO与账户模式</h3><p>Corda使用UTXO（未使用的交易输出）模型。每个交易消耗一组现有状态来产生一组新状态。</p>
<p>替代方案将是一个账户模型。在账户模型中，有状态对象存储在分类账上，事务采取请求的形式来更新这些对象的当前状态。</p>
<p>UTXO模型的主要优点是可以并行应用具有不同输入的交易，极大地增加了网络每秒潜在的交易量。在账户模型中，每秒交易数量受限于对给定对象的更新必须按顺序应用的事实。</p>
<h3 id="Code-is-law（代码即法律）-vs-existing-legal-systems（现有法律系统）"><a href="#Code-is-law（代码即法律）-vs-existing-legal-systems（现有法律系统）" class="headerlink" title="Code-is-law（代码即法律） vs. existing legal systems（现有法律系统）"></a>Code-is-law（代码即法律） vs. existing legal systems（现有法律系统）</h3><p>金融机构需要有能力利用传统的法律制度解决冲突。Corda旨在通过以下方式使其成为可能：</p>
<ul>
<li>拥有许可的网络，意味着参与者知道他们在每次交易中处理的是谁</li>
<li>所有的代码合约都有一份法律文件的支持，这些文件描述了可以依靠解决冲突的合约的预期行为</li>
</ul>
<h3 id="构建与重用"><a href="#构建与重用" class="headerlink" title="构建与重用"></a>构建与重用</h3><p>只要有可能，Corda就会重新使用现有技术，使整个平台更加强健。例如，Corda重复使用：</p>
<ul>
<li>用于开发CorDapps的标准JVM编程语言</li>
<li>现有的SQL数据库</li>
<li>现有的消息队列实现</li>
</ul>
<h2 id="原文"><a href="#原文" class="headerlink" title="原文"></a>原文</h2><p><a href="https://docs.corda.net/releases/release-V3.1/key-concepts.html" target="_blank" rel="noopener">https://docs.corda.net/releases/release-V3.1/key-concepts.html</a></p>

      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/corda/" rel="tag"># corda</a>
          
            <a href="/tags/r3/" rel="tag"># r3</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/05/30/blockchain/corda/Corda基础知识/" rel="next" title="Corda基础知识">
                <i class="fa fa-chevron-left"></i> Corda基础知识
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/06/01/blockchain/corda/Cordapp基础知识/" rel="prev" title="Cordapp基础知识">
                Cordapp基础知识 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/user-avatar"
                alt="Gavin Zhang" />
            
              <p class="site-author-name" itemprop="name">Gavin Zhang</p>
              <p class="site-description motion-element" itemprop="description">一个孤独的开发者，正在互联网公司踩坑<br />邮箱：zlcgavin@gmail.com</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">107</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">24</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">100</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Corda-Network"><span class="nav-number">1.</span> <span class="nav-text">Corda Network</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Network结构"><span class="nav-number">1.1.</span> <span class="nav-text">Network结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#doorman"><span class="nav-number">1.2.</span> <span class="nav-text">doorman</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Network中的服务"><span class="nav-number">1.3.</span> <span class="nav-text">Network中的服务</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#账本Ledger"><span class="nav-number">2.</span> <span class="nav-text">账本Ledger</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概观"><span class="nav-number">2.1.</span> <span class="nav-text">概观</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#身份Identity"><span class="nav-number">3.</span> <span class="nav-text">身份Identity</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#证书"><span class="nav-number">3.1.</span> <span class="nav-text">证书</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#状态"><span class="nav-number">4.</span> <span class="nav-text">状态</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概观-1"><span class="nav-number">4.1.</span> <span class="nav-text">概观</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#状态序列"><span class="nav-number">4.2.</span> <span class="nav-text">状态序列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#金库-Vault"><span class="nav-number">4.3.</span> <span class="nav-text">金库(Vault)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#合约"><span class="nav-number">5.</span> <span class="nav-text">合约</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#交易验证"><span class="nav-number">5.1.</span> <span class="nav-text">交易验证</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#合约沙箱"><span class="nav-number">5.2.</span> <span class="nav-text">合约沙箱</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#合约限制"><span class="nav-number">5.3.</span> <span class="nav-text">合约限制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#神谕（Oracle）"><span class="nav-number">5.4.</span> <span class="nav-text">神谕（Oracle）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#法律散文（legal-prose）"><span class="nav-number">5.5.</span> <span class="nav-text">法律散文（legal prose）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#交易"><span class="nav-number">6.</span> <span class="nav-text">交易</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#交易链"><span class="nav-number">6.1.</span> <span class="nav-text">交易链</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#提交交易"><span class="nav-number">6.2.</span> <span class="nav-text">提交交易</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#交易有效性"><span class="nav-number">6.3.</span> <span class="nav-text">交易有效性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#其他交易组件"><span class="nav-number">6.4.</span> <span class="nav-text">其他交易组件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#命令"><span class="nav-number">6.5.</span> <span class="nav-text">命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#附件"><span class="nav-number">6.6.</span> <span class="nav-text">附件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#时间窗口"><span class="nav-number">6.7.</span> <span class="nav-text">时间窗口</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#流程（Flow）"><span class="nav-number">7.</span> <span class="nav-text">流程（Flow）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#动机"><span class="nav-number">7.1.</span> <span class="nav-text">动机</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#流程框架"><span class="nav-number">7.2.</span> <span class="nav-text">流程框架</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#运行流程"><span class="nav-number">7.3.</span> <span class="nav-text">运行流程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#节点间通信"><span class="nav-number">7.3.1.</span> <span class="nav-text">节点间通信</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#子流程"><span class="nav-number">7.3.2.</span> <span class="nav-text">子流程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#流程库"><span class="nav-number">7.3.3.</span> <span class="nav-text">流程库</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#并发"><span class="nav-number">7.4.</span> <span class="nav-text">并发</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#共识"><span class="nav-number">8.</span> <span class="nav-text">共识</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#两种共识"><span class="nav-number">8.1.</span> <span class="nav-text">两种共识</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#唯一性共识"><span class="nav-number">8.2.</span> <span class="nav-text">唯一性共识</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#公证人（Notary）"><span class="nav-number">9.</span> <span class="nav-text">公证人（Notary）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概述"><span class="nav-number">9.1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#共识算法"><span class="nav-number">9.2.</span> <span class="nav-text">共识算法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#验证"><span class="nav-number">9.2.1.</span> <span class="nav-text">验证</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多个公证人"><span class="nav-number">9.3.</span> <span class="nav-text">多个公证人</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#改变公证人"><span class="nav-number">9.3.1.</span> <span class="nav-text">改变公证人</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#时间窗口-1"><span class="nav-number">10.</span> <span class="nav-text">时间窗口</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#在分布式系统中的时间"><span class="nav-number">10.1.</span> <span class="nav-text">在分布式系统中的时间</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#神谕（Oracle）-1"><span class="nav-number">11.</span> <span class="nav-text">神谕（Oracle）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概观-2"><span class="nav-number">11.1.</span> <span class="nav-text">概观</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#交易拆分"><span class="nav-number">11.2.</span> <span class="nav-text">交易拆分</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#节点"><span class="nav-number">12.</span> <span class="nav-text">节点</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#节点架构"><span class="nav-number">12.1.</span> <span class="nav-text">节点架构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#持久层"><span class="nav-number">12.2.</span> <span class="nav-text">持久层</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#网络接口"><span class="nav-number">12.3.</span> <span class="nav-text">网络接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RPC接口"><span class="nav-number">12.4.</span> <span class="nav-text">RPC接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#服务中心（ServiceHub）"><span class="nav-number">12.5.</span> <span class="nav-text">服务中心（ServiceHub）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CorDapp提供商"><span class="nav-number">12.6.</span> <span class="nav-text">CorDapp提供商</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#排水模式（Draining-mode）"><span class="nav-number">12.6.1.</span> <span class="nav-text">排水模式（Draining mode）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#权衡"><span class="nav-number">13.</span> <span class="nav-text">权衡</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Permissioned-vs-permissionless"><span class="nav-number">13.1.</span> <span class="nav-text">Permissioned vs. permissionless</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#点对点与全球广播"><span class="nav-number">13.2.</span> <span class="nav-text">点对点与全球广播</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UTXO与账户模式"><span class="nav-number">13.3.</span> <span class="nav-text">UTXO与账户模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-is-law（代码即法律）-vs-existing-legal-systems（现有法律系统）"><span class="nav-number">13.4.</span> <span class="nav-text">Code-is-law（代码即法律） vs. existing legal systems（现有法律系统）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#构建与重用"><span class="nav-number">13.5.</span> <span class="nav-text">构建与重用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#原文"><span class="nav-number">14.</span> <span class="nav-text">原文</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Gavin Zhang</span>

  

  
</div>




  <div class="powered-by">由 Gavin 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Muse</a> v6.0.4</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.0.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.0.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.4"></script>



  



	





  





  










  





  

  

  

  

  
  

  

  

  

  

</body>
</html>
